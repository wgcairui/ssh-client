# GitHub Actions ç¼“å­˜ç­–ç•¥

æœ¬æ–‡æ¡£æè¿°äº†ä¸º SSH å®¢æˆ·ç«¯é¡¹ç›®é…ç½®çš„ GitHub Actions ç¼“å­˜ç­–ç•¥ï¼Œæ—¨åœ¨å¤§å¹…æé«˜æ„å»ºé€Ÿåº¦ã€‚

## ğŸš€ ç¼“å­˜ä¼˜åŒ–æ¦‚è§ˆ

### ç¼“å­˜å±‚çº§
æˆ‘ä»¬å®ç°äº†å¤šå±‚ç¼“å­˜ç­–ç•¥æ¥æœ€å¤§åŒ–æ„å»ºæ•ˆç‡ï¼š

1. **Flutter SDK ç¼“å­˜** (å·²å†…ç½®åœ¨ flutter-action ä¸­)
2. **Pub ä¾èµ–ç¼“å­˜**
3. **Gradle Wrapper ç¼“å­˜**  
4. **Gradle ä¾èµ–ç¼“å­˜**
5. **Android æ„å»ºè¾“å‡ºç¼“å­˜**

### é¢„æœŸæ€§èƒ½æå‡

| æ„å»ºç±»å‹ | æ— ç¼“å­˜æ—¶é—´ | æœ‰ç¼“å­˜æ—¶é—´ | æå‡å¹…åº¦ |
|---------|-----------|-----------|---------|
| å†·å¯åŠ¨æ„å»º | 8-12 åˆ†é’Ÿ | 8-12 åˆ†é’Ÿ | 0% |
| ä¾èµ–æœªå˜æ›´ | 8-12 åˆ†é’Ÿ | 3-5 åˆ†é’Ÿ | 50-60% |
| å°ä»£ç å˜æ›´ | 8-12 åˆ†é’Ÿ | 2-4 åˆ†é’Ÿ | 60-75% |

## ğŸ“¦ ç¼“å­˜é…ç½®è¯¦æƒ…

### 1. Pub ä¾èµ–ç¼“å­˜
```yaml
- name: Cache Pub dependencies
  uses: actions/cache@v4
  with:
    path: |
      ~/.pub-cache
      **/.dart_tool
      **/.packages
    key: ${{ runner.os }}-pub-${{ hashFiles('**/pubspec.lock') }}
    restore-keys: |
      ${{ runner.os }}-pub-
```

**ç¼“å­˜å†…å®¹**: Flutter/Dart åŒ…ä¾èµ–
**æ›´æ–°æ¡ä»¶**: `pubspec.lock` æ–‡ä»¶å˜æ›´æ—¶
**å‘½ä¸­ç‡**: é«˜ï¼ˆä¾èµ–å˜æ›´ä¸é¢‘ç¹ï¼‰

### 2. Gradle Wrapper ç¼“å­˜
```yaml
- name: Cache Gradle Wrapper
  uses: actions/cache@v4
  with:
    path: ~/.gradle/wrapper
    key: ${{ runner.os }}-gradle-wrapper-${{ hashFiles('**/gradle/wrapper/gradle-wrapper.properties') }}
    restore-keys: |
      ${{ runner.os }}-gradle-wrapper-
```

**ç¼“å­˜å†…å®¹**: Gradle å¯æ‰§è¡Œæ–‡ä»¶
**æ›´æ–°æ¡ä»¶**: Gradle ç‰ˆæœ¬å‡çº§æ—¶
**å‘½ä¸­ç‡**: æé«˜ï¼ˆGradle ç‰ˆæœ¬å˜æ›´å¾ˆå°‘ï¼‰

### 3. Gradle ä¾èµ–ç¼“å­˜
```yaml
- name: Cache Gradle Dependencies
  uses: actions/cache@v4
  with:
    path: |
      ~/.gradle/caches
      ~/.gradle/buildOutputCleanup
    key: ${{ runner.os }}-gradle-caches-${{ hashFiles('**/*.gradle', '**/gradle.properties', '**/gradle/wrapper/gradle-wrapper.properties') }}
    restore-keys: |
      ${{ runner.os }}-gradle-caches-
```

**ç¼“å­˜å†…å®¹**: Android ä¾èµ–åŒ…å’Œæ„å»ºç¼“å­˜
**æ›´æ–°æ¡ä»¶**: Gradle é…ç½®æ–‡ä»¶å˜æ›´æ—¶
**å‘½ä¸­ç‡**: é«˜ï¼ˆAndroid ä¾èµ–å˜æ›´ä¸é¢‘ç¹ï¼‰

### 4. Android æ„å»ºç¼“å­˜
```yaml
- name: Cache Android Build
  uses: actions/cache@v4
  with:
    path: |
      android/app/build
      android/build
      android/.gradle
    key: ${{ runner.os }}-android-build-${{ hashFiles('android/**/*.gradle', 'android/**/gradle.properties', 'pubspec.lock') }}
    restore-keys: |
      ${{ runner.os }}-android-build-
```

**ç¼“å­˜å†…å®¹**: ç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶å’Œæ„å»ºè¾“å‡º
**æ›´æ–°æ¡ä»¶**: Android é…ç½®æˆ–ä¾èµ–å˜æ›´æ—¶
**å‘½ä¸­ç‡**: ä¸­ç­‰ï¼ˆä»£ç å˜æ›´ä¼šå½±å“éƒ¨åˆ†ç¼“å­˜ï¼‰

## ğŸ”§ æ„å»ºä¼˜åŒ–

### Release æ„å»ºä¼˜åŒ–
```bash
flutter build apk --release \
  --dart-define=FLUTTER_WEB_AUTO_DETECT=true \
  --split-per-abi \
  --obfuscate \
  --split-debug-info=build/app/outputs/symbols
```

**ä¼˜åŒ–ç‰¹æ€§**:
- âœ… **ä»£ç æ··æ·†**: å¢å¼ºå®‰å…¨æ€§å’Œå‡å°ä½“ç§¯
- âœ… **æ¶æ„åˆ†ç¦»**: ç”Ÿæˆé’ˆå¯¹ä¸åŒCPUæ¶æ„çš„å•ç‹¬APK
- âœ… **è°ƒè¯•ç¬¦å·åˆ†ç¦»**: ä¾¿äºå´©æºƒåˆ†æï¼ŒåŒæ—¶å‡å°APKä½“ç§¯
- âœ… **Webè‡ªåŠ¨æ£€æµ‹**: ä¼˜åŒ–Webç›¸å…³ä»£ç 

### Debug æ„å»ºä¼˜åŒ–
```bash
flutter build apk --debug \
  --dart-define=FLUTTER_WEB_AUTO_DETECT=true \
  --no-tree-shake-icons
```

**ä¼˜åŒ–ç‰¹æ€§**:
- âœ… **ä¿ç•™å›¾æ ‡**: ç¡®ä¿è°ƒè¯•ç‰ˆæœ¬å›¾æ ‡å®Œæ•´
- âœ… **å¿«é€Ÿæ„å»º**: è·³è¿‡ä¸å¿…è¦çš„ä¼˜åŒ–æ­¥éª¤

## ğŸ—‚ï¸ äº§ç‰©ç®¡ç†

### APK æ–‡ä»¶ç»“æ„
```
build/app/outputs/flutter-apk/
â”œâ”€â”€ app-debug.apk                    # Debug ç‰ˆæœ¬
â”œâ”€â”€ app-release.apk                  # Release é€šç”¨ç‰ˆæœ¬
â”œâ”€â”€ app-arm64-v8a-release.apk       # ARM64 ç‰ˆæœ¬
â”œâ”€â”€ app-armeabi-v7a-release.apk     # ARM32 ç‰ˆæœ¬
â””â”€â”€ app-x86_64-release.apk          # x86_64 ç‰ˆæœ¬
```

### ä¸Šä¼ ç­–ç•¥
- **Debug APK**: ä¿ç•™30å¤©
- **Release APK**: ä¿ç•™90å¤©
- **è°ƒè¯•ç¬¦å·**: ä¿ç•™90å¤©ï¼Œç”¨äºå´©æºƒåˆ†æ

## ğŸ¯ æœ€ä½³å®è·µ

### ç¼“å­˜é”®è®¾è®¡
1. **ç²¾ç¡®æ€§**: ä½¿ç”¨æ–‡ä»¶å“ˆå¸Œç¡®ä¿ç¼“å­˜ç²¾ç¡®æ€§
2. **å›é€€ç­–ç•¥**: ä½¿ç”¨ `restore-keys` æä¾›å›é€€é€‰é¡¹
3. **å‘½åç©ºé—´**: ä½¿ç”¨ `runner.os` åŒºåˆ†ä¸åŒæ“ä½œç³»ç»Ÿ

### ç¼“å­˜å¤±æ•ˆç­–ç•¥
1. **ä¸»åŠ¨å¤±æ•ˆ**: å…³é”®é…ç½®æ–‡ä»¶å˜æ›´æ—¶è‡ªåŠ¨å¤±æ•ˆ
2. **æ—¶é—´å¤±æ•ˆ**: GitHub é»˜è®¤7å¤©æœªä½¿ç”¨çš„ç¼“å­˜ä¼šè¢«æ¸…ç†
3. **ç©ºé—´é™åˆ¶**: ä»“åº“ç¼“å­˜æ€»é‡é™åˆ¶ä¸º10GB

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡
- **æ„å»ºæ—¶é—´**: ä»å¼€å§‹åˆ°APKç”Ÿæˆçš„æ€»æ—¶é—´
- **ç¼“å­˜å‘½ä¸­ç‡**: å„å±‚ç¼“å­˜çš„å‘½ä¸­ç™¾åˆ†æ¯”
- **ä¾èµ–ä¸‹è½½æ—¶é—´**: Pubå’ŒGradleä¾èµ–ä¸‹è½½è€—æ—¶
- **ç¼–è¯‘æ—¶é—´**: çº¯ç¼–è¯‘è¿‡ç¨‹è€—æ—¶

### ç›‘æ§æ–¹æ³•
1. åœ¨GitHub Actionsæ—¥å¿—ä¸­æŸ¥çœ‹ç¼“å­˜å‘½ä¸­/æœªå‘½ä¸­
2. æ¯”è¾ƒå¸¦ç¼“å­˜å’Œæ— ç¼“å­˜çš„æ„å»ºæ—¶é—´
3. è§‚å¯Ÿä¾èµ–ä¸‹è½½æ­¥éª¤çš„è€—æ—¶å˜åŒ–

## ğŸ”„ ç»´æŠ¤å»ºè®®

### å®šæœŸæ£€æŸ¥
- **æœˆåº¦**: æ£€æŸ¥ç¼“å­˜ä½¿ç”¨æƒ…å†µå’Œæ„å»ºæ—¶é—´è¶‹åŠ¿
- **ç‰ˆæœ¬æ›´æ–°æ—¶**: éªŒè¯æ–°ç‰ˆæœ¬Flutter/Gradleçš„ç¼“å­˜å…¼å®¹æ€§
- **ä¾èµ–å¤§æ›´æ–°æ—¶**: æ¸…ç†æ— æ•ˆç¼“å­˜ï¼Œé‡æ–°å»ºç«‹ç¼“å­˜åŸºçº¿

### æ•…éšœæ’æŸ¥
å½“æ„å»ºæ—¶é—´å¼‚å¸¸å¢é•¿æ—¶ï¼š
1. æ£€æŸ¥ç¼“å­˜æ˜¯å¦å‘½ä¸­
2. éªŒè¯ç¼“å­˜é”®æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ä¾èµ–æ˜¯å¦æœ‰å¤§å¹…å˜æ›´
4. è€ƒè™‘æ‰‹åŠ¨æ¸…ç†GitHubä»“åº“ç¼“å­˜

---

*æ­¤ç¼“å­˜ç­–ç•¥å°†éšç€é¡¹ç›®å‘å±•å’ŒGitHub ActionsåŠŸèƒ½æ›´æ–°è€ŒæŒç»­ä¼˜åŒ–*